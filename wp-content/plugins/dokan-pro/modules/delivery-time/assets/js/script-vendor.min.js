(()=>{"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,d=new Array(t);r<t;r++)d[r]=e[r];return d}function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(t,r){if(t){if("string"==typeof t)return e(t,r);var d=Object.prototype.toString.call(t).slice(8,-1);return"Object"===d&&t.constructor&&(d=t.constructor.name),"Map"===d||"Set"===d?Array.from(t):"Arguments"===d||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(d)?e(t,r):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var r,d;r=jQuery,d={init:function(){r("#vendor-delivery-time-date-picker").on("change",d.set_delivery_time_date_picker),r("#vendor-delivery-time-slot-picker").on("change",d.check_delivery_time_slot),r("#dokan-store-pickup-location").on("change",d.set_selected_store_location).trigger("change"),r(".delivery-type-delivery").on("click",d.set_delivery_order_type),r(".delivery-type-pickup").on("click",d.set_pickup_order_type)},init_dashboard_calendar:function(){if("undefined"!=typeof FullCalendar){for(var e="",t=FullCalendar.globalLocales.length,a=0;a<t;a++){if(0!==dokan_helper.week_starts_day&&(FullCalendar.globalLocales[a].week.dow=dokan_helper.week_starts_day),FullCalendar.globalLocales[a].code===dokan_full_calendar_i18n.code){e=dokan_full_calendar_i18n.code;break}if(FullCalendar.globalLocales[a].code===dokan_full_calendar_i18n.code_1){e=dokan_full_calendar_i18n.code_1;break}}var n=document.getElementById("delivery-time-calendar");new FullCalendar.Calendar(n,{locale:e,initialView:"dayGridMonth",initialDate:new Date,headerToolbar:{start:"dayGridMonth,timeGridWeek,timeGridDay,listWeek",center:"title",end:"today prev,next"},events:function(e,t,r){var a={action:"dokan_get_dashboard_calendar_event",start_date:moment(e.start).format("YYYY-MM-DD"),end_date:moment(e.end).format("YYYY-MM-DD"),nonce:dokan_delivery_time_calendar_nonce},n=d.get_filter_query_param("delivery_type_filter");n&&(a.type_filter=n),jQuery.post(dokan.ajaxurl,a,(function(e){e.success&&e.data.calendar_events&&t(Array.prototype.slice.call(e.data.calendar_events))}))},eventDidMount:function(e){r(e.el).tooltip({title:e.event.extendedProps.info.body,placement:"top",trigger:"hover",container:"body",animation:!0,html:!0})}}).render()}},set_delivery_time_date_picker:function(){var e=r("#vendor-delivery-time-date-picker"),t=e.data("vendor_id"),a=e.data("nonce"),n=e.attr("value");n?r("#vendor-delivery-time-date-picker").fadeIn(400):r("#vendor-delivery-time-date-picker").fadeOut(400);var i={action:"dokan_get_delivery_time_slot",vendor_id:t,nonce:a,date:n};i.date&&(r("#dokan_update_delivery_time").prop("disabled",!0),d.get_delivery_time_slots(i))},check_delivery_time_slot:function(){r("#vendor-delivery-time-slot-picker").val()&&("delivery"!==r("#vendor-delivery-type #selected-delivery-type").val()?r("#dokan-store-pickup-location").val()&&r("#dokan_update_delivery_time").prop("disabled",!1):r("#dokan_update_delivery_time").prop("disabled",!1))},set_order_details_delivery_calendar_config:function(){if("undefined"!=typeof vendorInfo){var e=vendorInfo,r={disable:[],minDate:"today",altInput:!0,altFormat:dokan_helper.i18n_date_format.replace("jS","J"),dateFormat:"Y-m-d"},d=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],a=Object.entries(e.vendor_delivery_options.delivery_day).map((function(e){return parseInt(e[1])||e[0]===e[1]?e[0]:""})).filter((function(e){return null!==e?e:""})),n=[];d.forEach((function(e){a.includes(e)||n.push(d.indexOf(e))}));var i=e.vendor_vacation_days,o=e.vendor_preorder_blocked_dates;r.disable=[function(e){return n.includes(e.getDay())}],r.disable=[].concat(t(r.disable),t(i),t(o)),flatpickr("#vendor-delivery-time-date-picker",r)}},get_delivery_time_slots:function(e){var t=r(".dokan-vendor-panel");t.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),r("#vendor-delivery-time-slot-picker").prop("disabled",!0),jQuery.post(dokan.ajaxurl,e,(function(e){t.unblock(),e.success&&(r("#vendor-delivery-time-slot-picker option:gt(0)").remove(),r.each(e.data.vendor_delivery_slots,(function(e,t){var d=dokan_get_formatted_time(t.start,dokan_get_i18n_time_format(),"hh:mm a"),a=dokan_get_formatted_time(t.end,dokan_get_i18n_time_format(),"hh:mm a");r("#vendor-delivery-time-slot-picker").append(r("<option></option>").attr("value",e).text("".concat(d," - ").concat(a)))})),r("#vendor-delivery-time-slot-picker").prop("disabled",!1))}))},get_filter_query_param:function(e){var t=new RegExp("[?&]"+e+"=([^&#]*)").exec(window.location.search);return null!==t&&(t[1]||0)},set_selected_store_location:function(){var e=r(this),t=e.val(),d=e.children("option:selected").data("value"),a=r(".delivery-time-slot-picker").val(),n=r("#vendor-delivery-type #selected-delivery-type").val();d?(a&&r("#dokan_update_delivery_time").prop("disabled",!1),r(".store-address").slideDown(300,(function(){r("#delivery-store-location-address").text(d)}))):r(".store-address").slideUp(300),"delivery"===n||t||r("#dokan_update_delivery_time").prop("disabled",!0)},set_delivery_order_type:function(){r("input.delivery-type-delivery")[0].hasAttribute("checked")||(r("input.delivery-type-delivery").attr("checked","checked"),r("input.delivery-type-pickup").removeAttr("checked")),d.update_vendor_delivery_content("slideUp","delivery")},set_pickup_order_type:function(){r("input.delivery-type-pickup")[0].hasAttribute("checked")||(r("input.delivery-type-pickup").attr("checked","checked"),r("input.delivery-type-delivery").removeAttr("checked")),d.update_vendor_delivery_content("slideDown","pickup")},update_vendor_delivery_content:function(e,t){var a=Vendor_Delivery_Data[t+"_date"],n=Vendor_Delivery_Data[t+"_time_heading"],i=Vendor_Delivery_Data[t+"_placeholder"];d.check_delivery_time_slot(),r("#vendor-delivery-type #selected-delivery-type").val(t),r(".delivery-time-box-heading").text(n),r(".delivery-type-date-info span").text(a),r(".delivery-time-date-picker").attr("placeholder",i),r(".store-pickup-select-options")[e](300),r("#dokan-store-pickup-location")[e](300)}},jQuery(document).ready((function(e){d.init(),d.set_order_details_delivery_calendar_config(),d.init_dashboard_calendar()}))})();